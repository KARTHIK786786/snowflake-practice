name: Run SQL with Snow CLI

on:
  push:
    branches: [main]

jobs:
  snowflake-run:
    runs-on: ubuntu-latest

    steps:
      - name: ✅ Checkout Repository
        uses: actions/checkout@v3

      - name: ✅ Install Snow CLI
        run: |
          pip install --upgrade pip
          pip install snowflake-cli-labs

      - name: ✅ Run SQL Script using inline connection
        run: |
          snow config init
          snow connection add devconn \
            --account-name pipbfcf-xr87735 \
            --username mithrakarthik2025 \
            --password Mithrakarthik2025NEW \
            --role ACCOUNTADMIN \
            --warehouse COMPUTE_WH \
            --database SNOWPARKDB \
            --schema SNOWPARKSCHEMA
          
          snow sql -c devconn -f 02_insert_data/insert_customer.sql
